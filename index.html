<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Th∆∞ Vi·ªán S·ªë ‚Äì ƒê·ªçc s√°ch, s√°ch n√≥i, truy·ªán tranh</title>
  <meta name="description" content="Th∆∞ Vi·ªán S·ªë ‚Äì kho s√°ch ƒëi·ªán t·ª≠ v√† s√°ch n√≥i mi·ªÖn ph√≠. Kh√°m ph√° tri th·ª©c, nu√¥i d∆∞·ª°ng t√¢m h·ªìn." />
  <meta name="theme-color" content="#009bd5" />
  <link rel="icon" href="nam/logo.jpg" type="image/jpeg" />

  <!-- TailwindCSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: { DEFAULT: '#009bd5', 50:'#effbff',100:'#d9f3ff',200:'#b8e9ff',300:'#86dbff',400:'#4dcbff',500:'#1ab7ff',600:'#009bd5',700:'#0079a6',800:'#065b7a',900:'#0a4b63' },
            ink: '#0b1222',
            gold: { 50:'#fff9e6', 100:'#ffefbf', 200:'#ffe38f', 300:'#ffd650', 400:'#ffc51f', 500:'#f5b400', 600:'#d49a00', 700:'#b78300', 800:'#8a6300', 900:'#6b4d00'}
          },
          boxShadow: { soft: '0 10px 30px rgba(0,0,0,.08)', glow: '0 8px 30px rgba(245,180,0,.35)' },
          backgroundImage: {
            'grid': 'radial-gradient(circle at 1px 1px, rgba(255,255,255,.15) 1px, transparent 0)',
            'gold-stripes': 'repeating-linear-gradient(45deg, rgba(255,197,31,.25) 0 10px, rgba(255,255,255,.12) 10px 20px)'
          },
          animation:{
            'shine': 'shine 2.2s linear infinite',
            'floaty':'floaty 3.5s ease-in-out infinite'
          },
          keyframes:{
            shine:{ '0%':{backgroundPosition:'-200% 0'}, '100%':{backgroundPosition:'200% 0'}},
            floaty:{ '0%,100%':{transform:'translateY(0px)'}, '50%':{transform:'translateY(-2px)'} }
          }
        }
      },
      darkMode: 'class'
    }
  </script>
  <style>
    .fade-in { animation: fade .6s ease both }
    .float-in { animation: float .8s ease both }
    @keyframes fade { from {opacity:0; transform: translateY(6px)} to {opacity:1; transform:none} }
    @keyframes float { from {opacity:.0; transform: translateY(10px) scale(.98)} to {opacity:1; transform:none} }
    .clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .glass { backdrop-filter: saturate(180%) blur(10px); background: rgba(255,255,255,.7) }
    .glass-dark { backdrop-filter: saturate(180%) blur(10px); background: rgba(13,18,34,.6) }
    .nav-active { background: rgba(0,0,0,.06); }
    .nav-active-dark { background: rgba(255,255,255,.08); }
    dialog::backdrop { background: rgba(0,0,0,.5); }
    /* Sao ƒë√°nh gi√° */
    .star { cursor: pointer; font-size: 20px; line-height: 1; transition: transform .1s ease; }
    .star[aria-checked="true"] { transform: scale(1.05); color: gold; }

    /* H√†ng TOP 1 vinh danh */
    .top1-row{
      position: relative;
      background: linear-gradient(90deg, rgba(255,230,150,.5), rgba(255,245,200,.8)) !important;
    }
    .dark .top1-row{
      background: linear-gradient(90deg, rgba(255,210,120,.20), rgba(255,230,170,.14)) !important;
    }
    .top1-crown{
      position: absolute;
      left: .35rem; top: 50%; transform: translateY(-50%);
      width: 26px; height: 26px;
      filter: drop-shadow(0 2px 4px rgba(245,180,0,.45));
      animation: floaty 3s ease-in-out infinite;
    }
    .top1-glow{
      position:absolute; inset:-2px;
      background: radial-gradient(120px 50% at 10% 50%, rgba(245,180,0,.35), transparent 60%);
      pointer-events:none;
      border-radius: 8px;
    }
    .shine-bar{
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.8), transparent);
      background-size: 200% 100%;
      animation: shine 2.8s linear infinite;
      position:absolute; inset:0; opacity:.35; pointer-events:none;
    }
    .rank-badge{
      font-weight:700; font-size:.85rem;
      padding:.2rem .5rem; border-radius:999px;
      background: linear-gradient(180deg, #ffd14d, #f5b400);
      color:#5b4100; box-shadow:0 2px 10px rgba(245,180,0,.35);
    }
    .dark .rank-badge{ color:#2a1d00; }
  </style>
</head>
<body class="bg-slate-50 text-ink dark:bg-slate-900 dark:text-slate-100">
  <!-- Header -->
  <header class="fixed top-0 inset-x-0 z-50">
    <div class="mx-auto max-w-7xl px-4">
      <div class="mt-3"></div>
      <div class="glass dark:glass-dark rounded-2xl shadow-soft px-4 py-3 flex items-center gap-3">
        <button id="btnNav" class="lg:hidden p-2 rounded-xl hover:bg-white/60 dark:hover:bg-white/10" aria-label="M·ªü menu">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor"><path d="M3 6h18M3 12h18M3 18h18"/></svg>
        </button>
        <a href="#home" class="flex items-center gap-3 shrink-0" data-link="home">
          <img src="nam/logo.jpg" alt="Th∆∞ vi·ªán s·ªë THPT ƒê·ªìng ƒêƒÉng" class="h-9 w-auto"/>
          <span class="hidden sm:block font-bold">Th∆∞ vi·ªán s·ªë THPT ƒê·ªìng ƒêƒÉng</span>
        </a>

        <!-- Top nav pages -->
        <nav class="ml-auto hidden lg:flex items-center gap-1">
          <a href="#home" data-link="home" class="px-3 py-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-white/10">Trang ch·ªß</a>
          <a href="#vinh-danh" data-link="vinh-danh" class="px-3 py-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-white/10">Vinh danh</a>
          <a href="#sach" data-link="sach" class="px-3 py-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-white/10">S√°ch</a>
          <a href="#quyen-gop" data-link="quyen-gop" class="px-3 py-1.5 rounded-lg hover:bg-white/60 dark:hover:bg-white/10">Quy√™n g√≥p s√°ch</a>
          <a href="https://www.facebook.com/profile.php?id=61583138231110&mibextid=wwXIfr&rdid=wqEiK6pLFNgThe2k&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1CCWXCqCSJ%2F%3Fmibextid%3DwwXIfr#" target="_blank" class="px-3 py-1.5 text-sm rounded-lg border border-slate-300/70 dark:border-slate-700 hover:bg-white/60 dark:hover:bg-white/10">Facebook</a>
          <button id="btnTheme" class="p-2 rounded-xl hover:bg-white/60 dark:hover:bg-white/10" aria-label="ƒê·ªïi giao di·ªán s√°ng/t·ªëi">
            <svg id="iconSun" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 block dark:hidden" viewBox="0 0 24 24" fill="currentColor"><path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.8 1.42-1.42zm10.48 14.32l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM1 13h3v-2H1v2zm19 0h3v-2H3v2zM4.95 19.05l1.41 1.41 1.8-1.79-1.41-1.41-1.8 1.79zM17.66 4.22l1.41-1.41 1.79 1.8-1.41 1.41-1.79-1.8zM12 6a6 6 0 100 12 6 6 0 000-12z"/></svg>
            <svg id="iconMoon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden dark:block" viewBox="0 0 24 24" fill="currentColor"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
          </button>
        </nav>
      </div>
    </div>
  </header>

  <!-- Mobile drawer -->
  <aside id="drawer" class="fixed inset-y-0 left-0 z-40 w-80 -translate-x-full transition-transform duration-300 bg-white dark:bg-slate-900 shadow-xl">
    <div class="p-4 flex items-center gap-2 border-b border-slate-200 dark:border-slate-800">
      <img src="nam/logo.jpg" class="h-8" alt="logo"/>
      <strong>Menu</strong>
      <button id="btnClose" class="ml-auto p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" aria-label="ƒê√≥ng">‚úï</button>
    </div>
    <nav class="p-2 overflow-y-auto h-[calc(100%-56px)]">
      <a class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" href="#home" data-link="home">Trang ch·ªß</a>
      <a class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" href="#vinh-danh" data-link="vinh-danh">Vinh danh</a>
      <a class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" href="#sach" data-link="sach">S√°ch</a>
      <a class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" href="#quyen-gop" data-link="quyen-gop">Quy√™n g√≥p s√°ch</a>
      <a class="block px-3 py-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800" href="https://www.facebook.com/profile.php?id=61583138231110&mibextid=wwXIfr&rdid=wqEiK6pLFNgThe2k&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1CCWXCqCSJ%2F%3Fmibextid%3DwwXIfr#" target="_blank">Facebook</a>
    </nav>
  </aside>

  <!-- PAGES -->
  <main class="pt-28 pb-16">
    <div class="mx-auto max-w-7xl px-4">

      <!-- PAGE: HOME -->
      <section id="page-home" class="space-y-10">
        <!-- Hero -->
        <div class="rounded-3xl overflow-hidden shadow-soft relative bg-white dark:bg-slate-800">
          <div class="absolute inset-0 opacity-[0.06] bg-grid bg-[length:18px_18px]"></div>
          <div class="grid md:grid-cols-2">
            <div class="p-8 md:p-12">
              <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold leading-tight fade-in">TH·∫ÆP S√ÅNG VƒÇN H√ìA ƒê·ªåC TR∆Ø·ªúNG THPT ƒê·ªíNG ƒêƒÇNG</h1>
              <p class="mt-3 text-slate-600 dark:text-slate-300 fade-in">H∆°n 10.000+ ƒë·∫ßu s√°ch, s√°ch n√≥i, truy·ªán tranh, phim t√†i li·ªáu‚Ä¶ Ho√†n to√†n mi·ªÖn ph√≠ & v√¨ c·ªông ƒë·ªìng.</p>
              <div class="mt-6 flex gap-3 fade-in">
                <a href="#sach" class="px-4 py-2.5 rounded-xl bg-primary text-white shadow hover:opacity-90" data-link="sach">Kh√°m ph√° S√°ch</a>
                <a href="#quyen-gop" class="px-4 py-2.5 rounded-xl border border-slate-300 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-white/10">Quy√™n g√≥p s√°ch</a>
              </div>
            </div>
            <div class="relative order-first md:order-last">
              <img src="nam/anh panner.jpg" alt="Minh ho·∫° th∆∞ vi·ªán s·ªë" class="w-full h-full object-cover md:h-[360px]"/>
              <div class="absolute right-4 bottom-4 bg-white/80 dark:bg-slate-900/80 rounded-xl px-4 py-3 shadow-soft">
                <p class="text-sm">‚ú® C·ªông ƒë·ªìng: <b>tri th·ª©c ‚Äì tr√≠ tu·ªá ‚Äì ph·ª•ng s·ª±</b></p>
              </div>
            </div>
          </div>
        </div>

        <!-- Video gi·ªõi thi·ªáu -->
        <section>
          <div class="flex items-center justify-between mb-3">
            <h2 class="text-xl font-bold">Video gi·ªõi thi·ªáu</h2>
            <span class="text-sm text-slate-500 dark:text-slate-400">Click ƒë·ªÉ xem</span>
          </div>
          <div id="videoGrid" class="grid gap-5 sm:grid-cols-2 md:grid-cols-3"></div>
        </section>

        <!-- Th√¥ng tin ng∆∞·ªùi qu·∫£n l√Ω -->
        <section>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold">Th√¥ng tin ng∆∞·ªùi qu·∫£n l√Ω</h2>
          </div>
          <div id="managerGrid" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-5 mt-3"></div>
        </section>

        <!-- C√°c ho·∫°t ƒë·ªông v·ªÅ s√°ch -->
        <section>
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold">C√°c ho·∫°t ƒë·ªông v·ªÅ s√°ch c·ªßa THPT ƒê·ªìng ƒêƒÉng</h2>
            <span class="text-sm text-slate-500 dark:text-slate-400"><code>ACTIVITIES</code></span>
          </div>
          <div id="activityGrid" class="grid gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 mt-3"></div>
        </section>
      </section>

      <!-- PAGE: VINH DANH -->
      <section id="page-vinh-danh" class="hidden space-y-6">
        <div class="rounded-2xl p-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft">
          <div class="flex items-center justify-between">
            <h2 class="text-xl font-bold">B·∫£ng vinh danh b·∫°n ƒë·ªçc t√≠ch c·ª±c</h2>
            <span class="text-sm text-slate-600 dark:text-slate-300">X·∫øp h·∫°ng theo l∆∞·ª£t truy c·∫≠p</span>
          </div>

          <div class="relative overflow-hidden rounded-xl border border-slate-200 dark:border-slate-700 mt-4">
            <table class="w-full text-sm relative">
              <thead class="bg-slate-50 dark:bg-slate-900/60">
                <tr>
                  <th class="px-3 py-2 text-left">#</th>
                  <th class="px-3 py-2 text-left">T√™n</th>
                  <th class="px-3 py-2 text-right">L∆∞·ª£t truy c·∫≠p</th>
                  <th class="px-3 py-2 text-right">Huy hi·ªáu</th>
                </tr>
              </thead>
              <tbody id="honorTable"></tbody>
            </table>
          </div>
          <p class="text-xs text-slate-500 mt-2">üèÜ Top 1 ƒë∆∞·ª£c g·∫Øn v∆∞∆°ng mi·ªán v√† l√†m n·ªïi b·∫≠t.</p>
        </div>
      </section>

      <!-- PAGE: S√ÅCH -->
      <section id="page-sach" class="hidden space-y-6">
        <div class="rounded-2xl p-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <h2 class="text-xl font-bold">Ch·ªçn danh m·ª•c s√°ch</h2>
            <button id="btnBackCategory" class="hidden px-3 py-1.5 text-sm rounded-lg border border-slate-300 dark:border-slate-700 hover:bg-white/60 dark:hover:bg-white/10">‚Üê Quay l·∫°i danh m·ª•c</button>
          </div>

          <!-- L∆∞·ªõi danh m·ª•c -->
          <div id="categoryGrid" class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-5 mt-4"></div>

          <!-- L∆∞·ªõi l·ªõp (hi·ªÉn th·ªã sau khi ch·ªçn danh m·ª•c) -->
          <div id="gradeGrid" class="hidden grid sm:grid-cols-2 md:grid-cols-3 gap-5 mt-4"></div>
        </div>
      </section>

      <!-- PAGE: QUY√äN G√ìP S√ÅCH -->
      <section id="page-quyen-gop" class="hidden space-y-6">
        <div class="rounded-2xl p-5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft">
          <div class="flex items-center justify-between flex-wrap gap-3">
            <h2 class="text-xl font-bold">Quy√™n g√≥p s√°ch</h2>
            <a id="donateFormBtn" href="https://docs.google.com/forms/d/e/1FAIpQLSfqNo7q2YgNE11Yonql8WlZY9xLYu71S9t18IDamdQCrOzxfA/viewform?usp=send_form" target="_blank" class="px-4 py-2.5 rounded-xl bg-primary text-white text-sm">M·ªü Google Form</a>
          </div>
          <div class="grid md:grid-cols-2 gap-6 mt-4">
            <div>
              <p class="text-sm text-slate-600 dark:text-slate-300">H·ªó tr·ª£ th∆∞ vi·ªán b·∫±ng c√°ch t·∫∑ng s√°ch gi·∫•y, PDF, ho·∫∑c chia s·∫ª b·∫£n quy·ªÅn. ƒêi·ªÅn Google Form ho·∫∑c qu√©t m√£ QR ƒë·ªÉ ƒë√≥ng g√≥p nhanh.</p>
              <ul class="mt-3 text-sm list-disc list-inside space-y-1">
                <li>Nh·∫≠p th√¥ng tin s√°ch (t√™n, t√°c gi·∫£, th·ªÉ lo·∫°i).</li>
                <li>Ch·ªçn h√¨nh th·ª©c quy√™n g√≥p (s√°ch gi·∫•y/PDF/kh√°c).</li>
                <li>G·ª≠i th√¥ng tin li√™n h·ªá ƒë·ªÉ ch√∫ng t√¥i x√°c nh·∫≠n.</li>
              </ul>
            </div>
            <div class="rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 p-4 grid place-items-center">
              <img id="qrDonate" src="nam/qr form.jpg" alt="QR quy√™n g√≥p" class="w-64 h-64 object-contain" />
              <p class="text-xs text-slate-500 mt-2">Qu√©t m√£ ƒë·ªÉ m·ªü form</p>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>

  <!-- Footer -->
  <footer>
    <div class="border-t border-slate-200 dark:border-slate-800"></div>
    <div class="mx-auto max-w-7xl px-4 py-10 grid md:grid-cols-4 gap-8">
      <div>
        <img src="nam/logo.jpg" class="h-10" alt="Th∆∞ Vi·ªán S·ªë"/>
        <p class="mt-3 text-slate-600 dark:text-slate-400">T√†i nguy√™n mi·ªÖn ph√≠ ‚Äì v√¨ m·ªçi ng∆∞·ªùi.</p>
      </div>
      <div>
        <h4 class="font-semibold">LI√äN H·ªÜ V·ªöI CH√öNG T√îI</h4>
        <ul class="mt-3 text-sm space-y-1">
          <li><b>C√î L∆Ø∆†NG T√ôNG D∆Ø∆†NG (Nh√¢n vi√™n th∆∞ vi·ªán):</b> 0987782101</li>
          <li><b>C√î L√ä TH·ªä PH∆Ø·ª¢NG (Tr∆∞·ªüng ban QL th∆∞ vi·ªán s·ªë):</b> 0965354699</li>
        </ul>
      </div>
      <div>
        <h4 class="font-semibold">K√äNH TRUY·ªÄN TH√îNG</h4>
        <ul class="mt-3 text-sm space-y-2">
          <li>C√¢u l·∫°c b·ªô Truy·ªÅn th√¥ng CMC: <a class="text-primary hover:underline" href="https://www.facebook.com/share/1B6TSCTgm3/?mibextid=wwXIfr" target="_blank">Facebook</a></li>
          <li>Th∆∞ vi·ªán s·ªë THPT ƒê·ªìng ƒêƒÉng: <a class="text-primary hover:underline" href="https://www.facebook.com/share/1CCWXCqCSJ/?mibextid=wwXIfr" target="_blank">Facebook</a></li>
        </ul>
      </div>
      <div>
        <h4 class="font-semibold">K·∫øt n·ªëi</h4>
        <div class="mt-4">
          <a class="inline-flex items-center gap-2 px-3 py-2 rounded-xl border border-slate-300 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-white/10" href="https://www.facebook.com/profile.php?id=61583138231110&mibextid=wwXIfr&rdid=wqEiK6pLFNgThe2k&share_url=https%3A%2F%2Fwww.facebook.com%2Fshare%2F1CCWXCqCSJ%2F%3Fmibextid%3DwwXIfr#" target="_blank">Facebook</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- Modal video -->
  <dialog id="videoModal" class="rounded-2xl w-[95%] max-w-3xl bg-white dark:bg-slate-900 p-0 overflow-hidden">
    <div class="flex items-center justify-between px-4 py-3 border-b border-slate-200 dark:border-slate-800">
      <h4 id="videoTitle" class="font-semibold">Xem video</h4>
      <button id="videoClose" class="p-1.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800">‚úï</button>
    </div>
    <div class="aspect-video">
      <video id="videoPlayer" class="w-full h-full" controls playsinline></video>
    </div>
  </dialog>

  <script>
    // ===== THEME =====
    const btnTheme = document.getElementById('btnTheme');
    if (localStorage.getItem('theme') === 'dark') document.documentElement.classList.add('dark');
    btnTheme?.addEventListener('click', () => {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
    });

    // ===== DRAWER =====
    const drawer = document.getElementById('drawer');
    document.getElementById('btnNav')?.addEventListener('click', () => drawer.classList.remove('-translate-x-full'));
    document.getElementById('btnClose')?.addEventListener('click', () => drawer.classList.add('-translate-x-full'));

    // ===== DATA: Video demo =====
    const VIDEOS = [
      { id: 'v1', title: '‚ù§Ô∏èCu·ªën s√°ch: M∆∞a ƒê·ªè (Chu Lai) ‚Äì Gi·∫£i khuy·∫øn kh√≠ch VHƒê L·∫°ng S∆°n 2025', poster: 'nam/anh vd1.jpg', src: 'nam/a1.mp4' },
      { id: 'v2', title: 'üìñVƒÉn t·∫ø nghƒ©a sƒ© C·∫ßn Giu·ªôc ‚Äì Gi·∫£i Ba VHƒê L·∫°ng S∆°n 2025', poster: 'nam/anh vd2.jpg', src: 'nam/a2.mp4' },
      { id: 'v3', title: 'üíñChi·∫øc √°o l√≠nh v√† B√† m·∫π ·ªü Ph√∫ Th·ªç B√°c H·ªì ‚Äì Nguy·ªÖn Th·∫£o My', poster: 'nam/anh vd3.jpg', src: 'nam/a3.mp4' },
      { id: 'v4', title: 'B√∫p Sen Xanh - S∆°n T√πng', poster: 'nam/anh vd4.jpg', src: 'nam/a4.mp4' },
      { id: 'v5', title: 'üíó√Åo ·∫§m B√°c Trao ‚Äì Ho√†ng Nguy·ªát √Ånh ‚Äì Gi·∫£i Ba', poster: 'nam/anh vd5.jpg', src: 'nam/a5.mov' },
    ];

    // ===== QU·∫¢N L√ù (v√≠ d·ª•) =====
    const MANAGERS = [
      { name: 'C√¥ L√™ Th·ªã Ph∆∞·ª£ng', role: 'GV Ng·ªØ vƒÉn ‚Äì Tr∆∞·ªüng ban Qu·∫£n l√≠ Th∆∞ vi·ªán s·ªë', avatar: 'nam/phuong.jpg' },
      { name: 'C√¥ L∆∞∆°ng T√πng D∆∞∆°ng', role: 'Nh√¢n vi√™n Th∆∞ vi·ªán ‚Äì H·ªó tr·ª£ b·∫°n ƒë·ªçc', avatar: 'nam/duong.jpg' },
      { name: 'Nguy·ªÖn V≈© Th√°i B√¨nh', role: 'HS 12A1 ‚Äì Ph√≥ ban Qu·∫£n l√≠ Th∆∞ vi·ªán s·ªë' , avatar: 'nam/binh.jpg' },
      { name: 'Ho√†ng Nguy·ªát √Ånh', role: 'HS 12A2 ‚Äì Th√†nh vi√™n Ban Qu·∫£n l√≠', avatar: 'nam/√°nh.jpg' },
      { name: 'LƒÉng H·ª©a Ng·ªçc Anh', role: 'HS 11A3 ‚Äì Th√†nh vi√™n Ban Qu·∫£n l√≠',  avatar: 'nam/ngoc anh.jpg' },
    ];

    // ===== ·∫¢NH HO·∫†T ƒê·ªòNG (v√≠ d·ª•) =====
    const ACTIVITIES = [
      { src: 'nam/hoi1.jpg', alt: 'Ho·∫°t ƒë·ªông 1' },
      { src: 'nam/hoi2.jpg', alt: 'Ho·∫°t ƒë·ªông 2' },
      { src: 'nam/hoi3.jpg', alt: 'Ho·∫°t ƒë·ªông 3' },
      { src: 'nam/hoi4.jpg', alt: 'Ho·∫°t ƒë·ªông 4' },
      { src: 'nam/hoi5.jpg', alt: 'Ho·∫°t ƒë·ªông 5' },
      { src: 'nam/hoi6.jpg', alt: 'Ho·∫°t ƒë·ªông 6' },
      { src: 'nam/hoi7.jpg', alt: 'Ho·∫°t ƒë·ªông 7' },
      { src: 'nam/hoi10.jpg', alt: 'Ho·∫°t ƒë·ªông 8' },
    ];

    // ===== VINH DANH =====
    const TOP_READERS = [
      { name: '√Çu V√¢n Anh', visits: 16753 },
      { name: 'Nguy·ªÖn Thu·ª∑ Chi', visits: 16574 },
      { name: 'T√¥n B·∫£o Y·∫øn', visits: 15432 },
      { name: 'Do√£n Ho√†ng Dung', visits: 14532 },
      { name: 'Nguy·ªÖn ƒê·∫∑ng M·ªπ Khu√™', visits: 13376 },
      { name: 'H·ª©a Minh Thu√Ω', visits: 12758 },
      { name: 'Ho√†ng H·ªìng H·∫£i', visits: 10256 },
      { name: 'Nguy·ªÖn Th·ªã Ph∆∞∆°ng Anh', visits: 9867 },
      { name: 'Ng√†n Kh√°nh Vy', visits: 8765 },
      { name: 'Tr·∫ßn Kim Anh', visits: 8427 },
    ];

    // ===== DANH M·ª§C S√ÅCH =====
    const CATEGORIES = [
      { slug:'hoc-tap', title:'S√°ch h·ªçc t·∫≠p', icon:'üìò', grades:[
        { grade:'L·ªõp 10', qr:'nam/hoctaplop10.jpg', drive:'https://drive.google.com/drive/folders/12p3tlmhD9C0incanW52Gyi1plap61aS8?usp=drive_link' },
        { grade:'L·ªõp 11', qr:'nam/hoctaplop11.jpg', drive:'https://drive.google.com/drive/folders/1_O1AQw0IQMbl8ONZkfQMsK78iSRbEgTj?usp=drive_link' },
        { grade:'L·ªõp 12', qr:'nam/hoctaplop12.jpg', drive:'https://drive.google.com/drive/folders/1vkSOZ0b68sEcVKDJXparrDp0NRs32Gvn?usp=drive_link' },
      ]},
      { slug:'lich-su', title:'S√°ch l·ªãch s·ª≠', icon:'üèõÔ∏è', grades:[
        { grade:'L·ªäCH S·ª¨ TH·∫æ GI·ªöI', qr:'nam/lichsuthegioi.jpg', drive:'https://drive.google.com/drive/folders/1HX7tvDhtOtE2hIoRuJ5v2vD6w5on7L9u?usp=drive_link' },
        { grade:'L·ªäCH S·ª¨ VI·ªÜT NAM', qr:'nam/lichsuvietnam.jpg', drive:'https://drive.google.com/drive/folders/1Pvz3_Jk1fXjPTzh6NsbXMfhm6XezzmE6?usp=drive_link' },
      ]},
      { slug:'van-hoc', title:'S√°ch vƒÉn h·ªçc', icon:'üß≠', grades:[
        { grade:'S√°ch vƒÉn h·ªçc t·ªïng h·ª£p', qr:'nam/sachvanhoc.jpg', drive:'https://drive.google.com/drive/folders/11fa_EX9ixrUba5edCheEQ7qPf_0Nqf4e?usp=drive_link' },
      ]},
      { slug:'sach-truyen', title:'S√°ch truy·ªán', icon:'üìñ', grades:[
        { grade:'TRUY·ªÜN C∆Ø·ªúI', qr:'nam/truyencuoi.jpg', drive:'https://drive.google.com/drive/folders/1th9U3MV8Q0OEp2mhxoPmNes6cWiGSqp0?usp=drive_link' },
        { grade:'TRUY·ªÜN KINH D·ªä', qr:'nam/truyenkinhdi.jpg', drive:'https://drive.google.com/drive/folders/1yKkncwlNDoAvfqkutg10NdIdFH5J9Iyt?usp=drive_link' },
        { grade:'TRUY·ªÜN TEEN ‚Äì TU·ªîI H·ªåC TR√í', qr:'nam/truyenteen.jpg', drive:'https://drive.google.com/drive/folders/1lA4yAX9-nsewiK_ojSWVaAF3in44O8oB?usp=drive_link' },
      ]},
      { slug:'ngoai-ngu', title:'S√°ch h·ªçc ngo·∫°i ng·ªØ', icon:'üåç', grades:[
        { grade:'Ngo·∫°i ng·ªØ', qr:'nam/ngoaingu.jpg', drive:'https://drive.google.com/drive/folders/1o2I5eYYgZ_k5ZZ8FhaYWpSK_6GUqFeQ_?usp=drive_link' },
      ]},
      { slug:'khoa-hoc', title:'S√°ch khoa h·ªçc', icon:'üî¨', grades:[
        { grade:'H√ìA H·ªåC', qr:'nam/hoahoc.jpg', drive:'https://drive.google.com/drive/folders/1sGqAiS-y8mfS8izgm_IhmnBUHnbY9XH8?usp=drive_link' },
        { grade:'SINH H·ªåC', qr:'nam/sinhhoc.jpg', drive:'https://drive.google.com/drive/folders/1_MpzdPmK5R-8e83Fq-IxcdInC9wbb3f4?usp=drive_link' },
        { grade:'TO√ÅN H·ªåC', qr:'nam/toanhoc.jpg', drive:'https://drive.google.com/drive/folders/12kNbkTHt7aKkkIGSu70RIQhGRSUtpYJZ?usp=drive_link' },
        { grade:'V·∫¨T L√ù', qr:'nam/vatly.jpg', drive:'https://drive.google.com/drive/folders/16jKFKiN2fw9GQW71fRtOof6j4po5-2An?usp=drive_link' },
      ]},
      { slug:'giao-khoa', title:'S√°ch gi√°o khoa', icon:'üìó', grades:[
        { grade:'L·ªõp 10', qr:'nam/giaokhoa10.jpg', drive:'https://drive.google.com/drive/folders/13AUmo8c8-3__RyecVCQ1eVpsv5_WPRSZ?usp=drive_link' },
        { grade:'L·ªõp 11', qr:'nam/giaokhoa11.jpg', drive:'https://drive.google.com/drive/folders/1lPHO3jErOIvMAo1wxiX43NN4iuzvlOog?usp=drive_link' },
        { grade:'L·ªõp 12', qr:'nam/giaokhoa12.jpg', drive:'https://drive.google.com/drive/folders/1zeq1sK2a6_vj94vAxSpClm5lNwbv4ZTr?usp=drive_link' },
      ]},
      { slug:'tam-ly', title:'S√°ch t√¢m l√Ω ‚Äì t√¨nh c·∫£m', icon:'üíñ', grades:[
        { grade:'t√¢m l√Ω t√¨nh c·∫£m', qr:'nam/tamlytinhcam.jpg', drive:'https://drive.google.com/drive/folders/1c8w7rk7lpDC4hoIPji9PsifAgvP-aSJ0?usp=drive_link' },
      ]},
    ];

    // ===== REVIEW STORAGE (online qua Netlify Functions + Blobs) =====
    const REVIEW_ENDPOINT = '/.netlify/functions/reviews';
    function reviewStorageKey(key){ return `reviews:${key}`; }

    const DEFAULT_REVIEW = {
      name: "Ho√†ng Nguy·ªát √Ånh ‚Äì HS 12A2",
      title: "Kho t√†i li·ªáu ƒë·∫ßy ƒë·ªß v√† d·ªÖ t√¨m!",
      text: "M·ª•c L·ªõp 10 r·∫•t ti·ªán, t√†i li·ªáu r√µ r√†ng. M·ªçi ng∆∞·ªùi nh·ªõ g√≥p √Ω ƒë·ªÉ th∆∞ vi·ªán ng√†y c√†ng t·ªët h∆°n nh√©.",
      rating: 5,
      ts: Date.now() - 36e5
    };

    async function loadReviews(key){
      if (REVIEW_ENDPOINT){
        try{
          const res = await fetch(`${REVIEW_ENDPOINT}?key=${encodeURIComponent(key)}`);
          if(!res.ok) throw new Error('Fetch reviews failed');
          const data = await res.json();
          // N·∫øu server ch∆∞a c√≥ d·ªØ li·ªáu th√¨ v·∫´n tr·∫£ m·∫∑c ƒë·ªãnh 1 b√¨nh lu·∫≠n m·∫´u
          return Array.isArray(data) && data.length ? data : [DEFAULT_REVIEW];
        }catch(e){ console.warn('Load remote reviews fail, fallback localStorage', e); }
      }
      try{
        const raw = localStorage.getItem(reviewStorageKey(key));
        if (raw){
          const list = JSON.parse(raw);
          return list.length ? list : [DEFAULT_REVIEW];
        }
      }catch{}
      return [DEFAULT_REVIEW];
    }

    async function saveReview(key, review){
      review.ts = Date.now();
      if (REVIEW_ENDPOINT){
        try{
          const res = await fetch(REVIEW_ENDPOINT, {
            method: 'POST',
            headers: { 'Content-Type':'application/json' },
            body: JSON.stringify({ key, review })
          });
          if(res.ok) return true;
        }catch(e){ console.warn('Save remote review fail, fallback localStorage', e); }
      }
      const list = await loadReviews(key);
      list.push(review);
      localStorage.setItem(reviewStorageKey(key), JSON.stringify(list));
      return true;
    }

    function avgRating(list){
      if(!list.length) return {avg:0,count:0};
      const sum = list.reduce((s,r)=>s+(Number(r.rating)||0),0);
      return { avg: (sum/list.length), count: list.length };
    }

    function escapeHtml(s=''){ return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'}[m])); }

    // ===== HELPERS =====
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    function setActiveLink(name){
      $$('[data-link]').forEach(a=>{
        const isActive = a.getAttribute('data-link') === name;
        a.classList.toggle('nav-active', isActive && !document.documentElement.classList.contains('dark'));
        a.classList.toggle('nav-active-dark', isActive && document.documentElement.classList.contains('dark'));
      });
    }

    // ===== RENDER HOME VIDEOS =====
    const videoGrid = document.getElementById('videoGrid');
    function renderVideos(){
      videoGrid.innerHTML = VIDEOS.map(v => `
        <article class="group rounded-2xl overflow-hidden bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft float-in">
          <button data-open-video="${v.id}" class="block relative text-left w-full">
            <img src="${v.poster}" alt="${v.title}" class="w-full aspect-video object-cover" loading="lazy"/>
            <span class="absolute inset-0 grid place-items-center text-white/95">
              <span class="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-black/60">‚ñ∂ Xem</span>
            </span>
          </button>
          <div class="p-3"><h3 class="font-semibold clamp-2">${v.title}</h3></div>
        </article>
      `).join('');
    }

    // ===== VIDEO MODAL =====
    const videoModal = document.getElementById('videoModal');
    const videoPlayer = document.getElementById('videoPlayer');
    const videoTitle = document.getElementById('videoTitle');
    function bindVideoEvents(){
      videoGrid.addEventListener('click', (e)=>{
        const btn = e.target.closest('[data-open-video]');
        if(!btn) return;
        const vid = VIDEOS.find(x => x.id === btn.getAttribute('data-open-video'));
        if(!vid) return;
        videoTitle.textContent = vid.title;
        videoPlayer.src = vid.src;
        videoPlayer.play();
        videoModal.showModal();
      });
      document.getElementById('videoClose').addEventListener('click', closeVideo);
      videoModal.addEventListener('close', closeVideo);
      function closeVideo(){
        videoPlayer.pause();
        videoPlayer.removeAttribute('src');
        videoPlayer.load();
      }
    }

    // ===== VINH DANH =====
    const honorTable = document.getElementById('honorTable');
    function crownSvg(){
      return `
        <svg class="top1-crown" viewBox="0 0 64 64" fill="none" aria-hidden="true">
          <path d="M8 22l10 12 14-18 14 18 10-12 0 22H8V22z" fill="#F5B400" stroke="#8A6300" stroke-width="2"/>
          <circle cx="16" cy="22" r="3" fill="#FFD14D"/><circle cx="48" cy="22" r="3" fill="#FFD14D"/><circle cx="32" cy="16" r="4" fill="#FFE38F" stroke="#8A6300" stroke-width="1"/>
        </svg>`;
    }
    function renderHonor(){
      const sorted = [...TOP_READERS].sort((a,b)=>b.visits - a.visits);
      honorTable.innerHTML = sorted.map((u,idx)=>{
        const isTop1 = idx===0;
        const trClass = isTop1
          ? 'top1-row shadow-glow ring-1 ring-gold-300 dark:ring-gold-700'
          : (idx % 2 ? 'bg-slate-50/50 dark:bg-slate-900/30' : '');
        const nameCell = isTop1
          ? `
            <div class="relative pl-9">
              <span class="top1-glow"></span>
              ${crownSvg()}
              <span class="font-semibold">${u.name}</span>
            </div>
          `
          : `<span>${u.name}</span>`;
        const rankBadge = isTop1
          ? `<span class="rank-badge">#1</span>`
          : (idx<3 ? `<span class="text-amber-600 dark:text-amber-400 font-semibold">Top ${idx+1}</span>` : ``);
        return `
          <tr class="${trClass}">
            <td class="relative px-3 py-2 font-bold">${idx+1}${isTop1?`<span class="shine-bar"></span>`:''}</td>
            <td class="px-3 py-2">${nameCell}</td>
            <td class="px-3 py-2 text-right font-medium">${u.visits.toLocaleString('vi-VN')}</td>
            <td class="px-3 py-2 text-right">${rankBadge}</td>
          </tr>
        `;
      }).join('');
    }

    // ===== RENDER MANAGERS =====
    const managerGrid = document.getElementById('managerGrid');
    function renderManagers(){
      managerGrid.innerHTML = MANAGERS.map(m => `
        <article class="rounded-2xl overflow-hidden bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft p-5 flex items-center gap-5">
          <img src="${m.avatar}" alt="${m.name}" class="w-28 h-28 object-cover rounded-xl border border-slate-200 dark:border-slate-700">
          <div>
            <h3 class="font-semibold text-lg"><span class="text-primary">${m.name}</span></h3>
            <p class="text-sm text-slate-600 dark:text-slate-300 mt-1">${m.role}</p>
          </div>
        </article>
      `).join('');
    }

    // ===== RENDER ACTIVITIES =====
    const activityGrid = document.getElementById('activityGrid');
    function renderActivities(){
      activityGrid.innerHTML = ACTIVITIES.map(a=>`
        <figure class="rounded-2xl overflow-hidden bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 shadow-soft">
          <img src="${a.src}" alt="${a.alt||'Ho·∫°t ƒë·ªông'}" class="w-full aspect-[4/3] object-cover" loading="lazy">
          <figcaption class="px-3 py-2 text-xs text-slate-600 dark:text-slate-300">${a.alt||''}</figcaption>
        </figure>
      `).join('');
    }

    // ===== S√ÅCH: render danh m·ª•c & l·ªõp (QR + Drive + Reviews) =====
    const categoryGrid = document.getElementById('categoryGrid');
    const gradeGrid = document.getElementById('gradeGrid');
    const btnBackCategory = document.getElementById('btnBackCategory');
    let currentCategory = null;

    function renderCategories(){
      currentCategory = null;
      btnBackCategory.classList.add('hidden');
      gradeGrid.classList.add('hidden');
      categoryGrid.classList.remove('hidden');

      categoryGrid.innerHTML = CATEGORIES.map(cat=>`
        <button data-cat="${cat.slug}" class="text-left rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 shadow-soft p-4 hover:shadow-md transition">
          <div class="flex items-center gap-3">
            <div class="text-2xl" aria-hidden="true">${cat.icon || 'üìö'}</div>
            <div>
              <h3 class="font-semibold">${cat.title}</h3>
              <p class="text-xs text-slate-500 dark:text-slate-400">Nh·∫•p ƒë·ªÉ xem n·ªôi dung</p>
            </div>
          </div>
        </button>
      `).join('');
    }

    function renderGrades(cat){
      currentCategory = cat;
      btnBackCategory.classList.remove('hidden');
      categoryGrid.classList.add('hidden');
      gradeGrid.classList.remove('hidden');

      gradeGrid.innerHTML = cat.grades.map(g=>{
        const key = `${cat.slug}__${g.grade.replace(/\s+/g,'_')}`;
        return `
          <article class="rounded-2xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 shadow-soft overflow-hidden" data-review-key="${key}">
            <div class="p-4 border-b border-slate-200 dark:border-slate-700">
              <h3 class="font-semibold">${cat.title} ‚Äì <span class="text-primary">${g.grade}</span></h3>
              <p class="text-xs text-slate-500 dark:text-slate-400 mt-1">Qu√©t QR ho·∫∑c m·ªü th∆∞ m·ª•c Google Drive.</p>
            </div>
            <div class="p-4 grid place-items-center">
              <img src="${g.qr}" alt="QR ${cat.title} ${g.grade}" class="w-48 h-48 object-contain" loading="lazy">
              <a href="${g.drive}" target="_blank" class="mt-3 inline-flex items-center gap-2 px-3 py-2 rounded-xl bg-primary text-white text-sm">M·ªü Google Drive</a>
            </div>

            <!-- ƒê√ÅNH GI√Å & B√åNH LU·∫¨N -->
            <div class="p-4 border-t border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/40">
              <div class="flex items-center justify-between gap-3">
                <h4 class="font-semibold">ƒê√°nh gi√° & b√¨nh lu·∫≠n</h4>
                <span class="text-sm text-slate-600 dark:text-slate-300" data-avg>‚òÖ 0.0 (0)</span>
              </div>

              <!-- Ch·ªçn sao -->
              <div class="mt-2 flex items-center gap-1" role="radiogroup" aria-label="Ch·ªçn s·ªë sao" data-stars>
                ${[1,2,3,4,5].map(n=>`<button type="button" class="star" aria-checked="false" data-star="${n}" title="${n} sao">‚òÖ</button>`).join('')}
              </div>

              <!-- Form nh·∫≠p -->
              <div class="mt-3 grid sm:grid-cols-2 gap-2">
                <input type="text" placeholder="T√™n hi·ªÉn th·ªã (tu·ª≥ ch·ªçn)" class="px-3 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700" data-name>
                <input type="text" placeholder="Ti√™u ƒë·ªÅ (tu·ª≥ ch·ªçn)" class="px-3 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700" data-title>
              </div>
              <textarea rows="3" placeholder="Chia s·∫ª c·∫£m nh·∫≠n v·ªÅ s√°ch..." class="mt-2 w-full px-3 py-2 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700" data-text></textarea>

              <div class="mt-2 flex items-center justify-end gap-2">
                <button type="button" class="px-3 py-2 rounded-lg border border-slate-300 dark:border-slate-700 hover:bg-white/70 dark:hover:bg-white/10" data-clear>Nh·∫≠p l·∫°i</button>
                <button type="button" class="px-3 py-2 rounded-lg bg-primary text-white" data-submit>G·ª≠i ƒë√°nh gi√°</button>
              </div>

              <!-- Danh s√°ch b√¨nh lu·∫≠n -->
              <ul class="mt-4 space-y-3" data-list></ul>
            </div>
          </article>
        `;
      }).join('');

      bindReviewPanels();
    }

    function bindReviewPanels(){
      $$('#gradeGrid [data-review-key]').forEach(panel=>{
        const key = panel.getAttribute('data-review-key');
        const starWrap = panel.querySelector('[data-stars]');
        const nameInput = panel.querySelector('[data-name]');
        const titleInput = panel.querySelector('[data-title]');
        const textArea = panel.querySelector('[data-text]');
        const btnSubmit = panel.querySelector('[data-submit]');
        const btnClear = panel.querySelector('[data-clear]');
        const listEl = panel.querySelector('[data-list]');
        const avgEl = panel.querySelector('[data-avg]');

        let currentStars = 0;

        // Ch·ªçn sao
        starWrap.addEventListener('click', e=>{
          const btn = e.target.closest('[data-star]');
          if(!btn) return;
          currentStars = Number(btn.getAttribute('data-star')) || 0;
          starWrap.querySelectorAll('[data-star]').forEach(b=>{
            const val = Number(b.getAttribute('data-star'));
            const checked = val <= currentStars;
            b.setAttribute('aria-checked', checked ? 'true':'false');
            b.style.color = checked ? 'gold' : '';
          });
        });

        // Xo√° form
        btnClear.addEventListener('click', ()=>{
          currentStars = 0;
          nameInput.value = '';
          titleInput.value = '';
          textArea.value = '';
          starWrap.querySelectorAll('[data-star]').forEach(b=>{
            b.setAttribute('aria-checked','false');
            b.style.color = '';
          });
        });

        // G·ª≠i
        btnSubmit.addEventListener('click', async ()=>{
          const rating = currentStars;
          const text = textArea.value.trim();
          if (!rating){ alert('Vui l√≤ng ch·ªçn s·ªë sao.'); return; }
          if (!text){ alert('Vui l√≤ng nh·∫≠p n·ªôi dung b√¨nh lu·∫≠n.'); return; }
          const review = {
            name: nameInput.value.trim() || '·∫®n danh',
            title: titleInput.value.trim(),
            text, rating
          };
          await saveReview(key, review);
          renderList();
          btnClear.click();
        });

        // Render danh s√°ch + ƒëi·ªÉm trung b√¨nh
        async function renderList(){
          const data = await loadReviews(key);
          data.sort((a,b)=> (b.ts||0) - (a.ts||0));
          const {avg,count} = avgRating(data);
          avgEl.textContent = `‚òÖ ${avg.toFixed(1)} (${count})`;

          listEl.innerHTML = data.map(r=>{
            const when = r.ts ? new Date(r.ts).toLocaleString('vi-VN') : '';
            const stars = '‚òÖ'.repeat(Number(r.rating)||0) + '‚òÜ'.repeat(5-(Number(r.rating)||0));
            return `
              <li class="rounded-xl border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 p-3">
                <div class="flex items-center justify-between">
                  <div class="font-medium">${escapeHtml(r.name||'·∫®n danh')}</div>
                  <div class="text-sm" title="${r.rating} sao">${stars}</div>
                </div>
                ${r.title ? `<div class="mt-0.5 text-sm text-primary font-medium">${escapeHtml(r.title)}</div>`:''}
                <p class="mt-1 text-sm text-slate-700 dark:text-slate-300">${escapeHtml(r.text)}</p>
                <div class="mt-1 text-xs text-slate-500">${when}</div>
              </li>
            `;
          }).join('') || `<li class="text-sm text-slate-500">Ch∆∞a c√≥ b√¨nh lu·∫≠n n√†o. H√£y l√† ng∆∞·ªùi ƒë·∫ßu ti√™n!</li>`;
        }

        // Kh·ªüi t·∫°o
        renderList();
      });
    }

    // ===== L·∫ÆNG NGHE CH·ªåN DANH M·ª§C =====
    categoryGrid.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-cat]');
      if(!btn) return;
      const cat = CATEGORIES.find(c => c.slug === btn.getAttribute('data-cat'));
      if(cat) renderGrades(cat);
    });

    btnBackCategory.addEventListener('click', renderCategories);

    // ===== ROUTER =====
    const pageHome = document.getElementById('page-home');
    const pageSach = document.getElementById('page-sach');
    const pageVinhDanh = document.getElementById('page-vinh-danh');
    const pageQuyenGop = document.getElementById('page-quyen-gop');

    function showPage(name){
      [pageHome, pageSach, pageVinhDanh, pageQuyenGop].forEach(sec=>sec.classList.add('hidden'));

      if(name === 'sach'){
        pageSach.classList.remove('hidden');
        renderCategories();
      } else if (name === 'vinh-danh'){
        pageVinhDanh.classList.remove('hidden');
        renderHonor();
      } else if (name === 'quyen-gop'){
        pageQuyenGop.classList.remove('hidden');
      } else {
        pageHome.classList.remove('hidden');
        renderManagers();
        renderActivities();
      }
      setActiveLink(name==='sach'?'sach':name==='vinh-danh'?'vinh-danh':name==='quyen-gop'?'quyen-gop':'home');
      drawer.classList.add('-translate-x-full');
    }

    function handleRoute(){
      const hash = (location.hash || '#home').replace('#','');
      if (hash === 'sach'){
        showPage('sach');
      } else if (hash === 'vinh-danh'){
        showPage('vinh-danh');
      } else if (hash === 'quyen-gop'){
        showPage('quyen-gop');
      } else {
        showPage('home');
      }
    }

    // ===== INIT =====
    renderVideos();
    bindVideoEvents();
    setActiveLink('home');
    window.addEventListener('hashchange', handleRoute);
    window.addEventListener('DOMContentLoaded', handleRoute);

    // ƒê·ªïi class active khi theme ƒë·ªïi
    const observer = new MutationObserver(()=>setActiveLink(
      (location.hash||'#home').includes('sach') ? 'sach'
      : (location.hash||'#home').includes('vinh-danh') ? 'vinh-danh'
      : (location.hash||'#home').includes('quyen-gop') ? 'quyen-gop'
      : 'home'
    ));
    observer.observe(document.documentElement, { attributes: true, attributeFilter:['class'] });
  </script>
</body>
</html>
